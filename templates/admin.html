{% extends "base.html" %}
{% block content %}
<h2 class="mb-3">Πίνακας Διαχείρισης</h2>

<div class="card mb-3">
  <div class="card-body">
    <form method="post" action="{{ url_for('run_scraper') }}" class="row g-2 align-items-end">
      <div class="col-md-3">
        <label class="form-label">Πηγή</label>
        <select name="source" class="form-select">
          <option value="all">Όλες</option>
          <option value="naftemporiki">Ναυτεμπορική</option>
          <option value="kathimerini">Καθημερινή</option>
        </select>
      </div>
      <div class="col-md-2">
        <label class="form-label">Σελίδες</label>
        <input type="number" name="pages" class="form-control" value="1" min="1" max="50">
      </div>
      <div class="col-md-2">
        <label class="form-label">Delay (sec)</label>
        <input type="text" name="delay" class="form-control" value="1.0">
      </div>
      <div class="col-md-5">
        <button class="btn btn-primary">▶ Run Scraper</button>
        <a href="{{ url_for('create_article') }}" class="btn btn-success ms-2">➕ Νέο Άρθρο</a>
      </div>
    </form>
  </div>
</div>

<table class="table table-striped table-bordered align-middle">
  <thead class="table-dark">
    <tr>
      <th>Τίτλος</th>
      <th>Ημερομηνία</th>
      <th>Κατηγορία</th>
      <th>Πηγή</th>
      <th>Ενέργειες</th>
    </tr>
  </thead>
  <tbody>
    {% for a in articles %}
    <tr>
      <td style="max-width: 360px; word-wrap: break-word;">{{ a['title'] }}</td>
      <td>{{ a['published_at'] }}</td>
      <td>{{ a['category'] or '-' }}</td>
      <td>{{ a['source'] or '-' }}</td>
      <td>
        <a href="{{ url_for('update_article', id=a['_id']) }}" class="btn btn-sm btn-warning">✏️ Επεξεργασία</a>
        <a href="{{ url_for('delete_article', id=a['_id']) }}" class="btn btn-sm btn-danger"
           onclick="return confirm('Σίγουρα να διαγραφεί;')">🗑️ Διαγραφή</a>
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="5" class="text-center">Δεν υπάρχουν άρθρα στη βάση.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
